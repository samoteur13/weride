{% extends "../../main.html.twig" %}
{% block main %}

	{% if not inspectedUser %}
		{% set inspectedUser = user %}
	{% endif %}

	<main class="">
		{# section profil #}
		<section class="card col-12 col-md-6 col-lg-6 mt-3 container p-0 d-flex align-items-center">
			{% if not inspectedUser.picture %}
					<a href="/profil/{{inspectedUser._id}}" class="col-2 p-1"><img class="col-12 rounded-circle" src="../pictures/default.jpg" class="card-img-top"/></a>
				{% else %}
					<a href="/profil/{{inspectedUser._id}}" class="col-2 p-1"><img class="col-12 rounded-circle" src="/images/userImages/{{inspectedUser.id}}/{{inspectedUser.picture}}" alt="image de profil" class="card-img-top"/></a>
				{% endif %}
			<p class="card-title h5">{{inspectedUser.pseudo}}</p>
			<p class="card-subtitle mb-2 text-muted">{{user.motoUser[0].brand}}
				{{user.motoUser[0].model}}
				{{user.motoUser[0].cylinder}}</p>

		</section>

		{# section moto #}
		<section class="card col-12 col-md-6 col-lg-6 mt-3 container p-0">
			<div class="d-flex justify-content-between">
				<h2 class="card-title m-0 p-1">Moto</h2>
				<button type="button" class="m-1 p-0 btn btn-light">
					<a href='/nouvelleMoto' class="nav-link p-0" aria-current="page">Ajouter une moto</a>
				</button>
			</div>
			<hr class="m-0">
			{% if inspectedUser.motoUser.length == 0 %}
				<p class="mx-auto my-2 text-danger">
					Hey l'ami, tu n'as pas de bécane !</p>
			{% endif %}
			{% for moto in inspectedUser.motoUser %}
				<article class="row card-body text-center border border-muted rounded m-2">
					<h5 class="card-title">{{moto.brand}}</h5>
					<h6 class="card-subtitle mb-2 text-muted">{{moto.model}}
						{{moto.cylinder}}</h6>
					<button type="button" class="mt-1 mb-1 p-0   btn btn-light">
						<a href="/supprimerMoto/{{moto._id}}" class="nav-link p-0" aria-current="page">Supprimer</a>
					</button>
				</article>
			{% endfor %}
		</section>

		{# section mes sortie #}
		<section class="card col-12 col-md-6 col-lg-6 mt-3 bg-light container p-0">
			<h2 class="card-title m-0 p-1">Mes sorties</h2>
			<hr class="m-0">
			{% if inspectedUser.eventUser.length == 0 %}
				<p class="mx-auto my-2 text-danger">Hey l'ami, tu n'as aucune sortie organisée !</p>
			{% endif %}
			{% for event in inspectedUser.eventUser %}
				<article class="row card-body d-flex justify-content-end border border-muted rounded m-2">
					<div class="col-6 d-flex flex-column justify-content-between">
						<div class=" d-flex  align-items-center">
							<a href="/profil/{{inspectedUser._id}}" class="col-2 p-1"><img class="col-12 rounded-circle" src="/images/userImages/{{inspectedUser.id}}/{{inspectedUser.picture}}" alt="image de profil" class="card-img-top"/></a>
							<div>
								<h6 class="card-title">{{inspectedUser.pseudo}}</h6>
								<p class="card-subtitle mb-2 text-muted">{{user.motoUser[0].brand}}
									{{user.motoUser[0].model}}
									{{user.motoUser[0].cylinder}}</p>
							</div>
						</div>
						<h5 style="color:#2b3658;" class=" m-0">{{event.departureLocation}}</h5>
						<h5 style="color:#2b3658;" class=" m-0">{{event.backLocation}}</h5>
						<p class="m-0 text-secondary">&#x1F552; Du
							{{event.startDate|date("d/m/Y")}}
							au
							{{event.endDate|date("d/m/Y")}}</p>
						<!-- pour configurer le format de la date -->
						<p class="text-success m-0">Rider
							{{event.riderJoin.length}}+</p>
					</div>
					<div class="col-6">
						<iframe title="card exemple" src="https://www.google.com/maps/embed?pb=!1m28!1m12!1m3!1d1456402.9825108857!2d3.921280050206282!3d44.524634635339055!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!4m13!3e6!4m5!1s0x12c9bf4344da5333%3A0x40819a5fd970220!2sMarseille!3m2!1d43.296482!2d5.3697799999999996!4m5!1s0x47f4ea516ae88797%3A0x408ab2ae4bb21f0!2sLyon!3m2!1d45.764043!2d4.835659!5e0!3m2!1sfr!2sfr!4v1647353202440!5m2!1sfr!2sfr" width="100%" height="" style="border-radius:5;" allowfullscreen="" loading="lazy"></iframe>
						<div class="d-flex justify-content-end">
							<a href="/evenement/{{event._id}}/{{inspectedUser._id}}" class="btn btn-light text-primary col-4">Détails</a>
						</div>
					</div>
				</article>
			{% endfor %}
		</section>

		{# section je participe #}
		<section class="card col-12 col-md-6 col-lg-6 mt-3 bg-light container p-0" id="{{event._id}}">
			<h2 class="card-title m-0 p-1">Je participe</h2>
			<hr class="m-0">
			{% if inspectedUser.eventUser.length == 0 %}
				<p class="mx-auto my-2 text-danger">Hey l'ami, tu ne participes à aucune sortie !</p>
			{% endif %}
			{% for authorEvent in authorsEvent %}
				{% for event in authorEvent.userEvent %}
					<article class="row card-body d-flex justify-content-end border border-muted rounded m-2">
						<div class="col-6 d-flex flex-column justify-content-between">
							<div class=" d-flex  align-items-center">
								<a href="/profil/{{authorEvent.authorEventInfo.id}}" class="col-2 p-1"><img class="col-2 p-1 rounded-circle" src="/images/userImages/{{authorEvent.authorEventInfo.id}}/{{authorEvent.authorEventInfo.picture}}" alt="image de profil qui organise une sortie" class="card-img-top"/></a>
								<div>
									<h6 class="card-title">{{authorEvent.authorEventInfo.pseudo}}</h5>
									<p class="card-subtitle mb-2 text-muted">{{authorEvent.authorEventInfo.motoUser[0].brand}} {{authorEvent.authorEventInfo.motoUser[0].model}} {{authorEvent.authorEventInfo.motoUser[0].cylinder}}</p>
								</div>
							</div>
							<h5 style="color:#2b3658;" class=" ">{{event.departureLocation}}</h5>
							<h5 style="color:#2b3658;" class=" ">{{event.backLocation}}</h5>
							<p class="m-0 text-secondary">&#x1F552; Du {{event.startDate|date("d/m/Y")}} au {{event.endDate|date("d/m/Y")}}</p> <!-- pour configurer le format de la date -->
							<p class="text-success m-0">Rider {{event.riderJoin.length}}+</p>
						</div>
						<div class="col-6">
							<iframe  title="card exemple" src="https://www.google.com/maps/embed?pb=!1m28!1m12!1m3!1d1456402.9825108857!2d3.921280050206282!3d44.524634635339055!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!4m13!3e6!4m5!1s0x12c9bf4344da5333%3A0x40819a5fd970220!2sMarseille!3m2!1d43.296482!2d5.3697799999999996!4m5!1s0x47f4ea516ae88797%3A0x408ab2ae4bb21f0!2sLyon!3m2!1d45.764043!2d4.835659!5e0!3m2!1sfr!2sfr!4v1647353202440!5m2!1sfr!2sfr" width="100%" height="" style="border-radius:5;" allowfullscreen="" loading="lazy"></iframe>

							{# Verifie si l'utilisateur participe à la sortie ou non #}
							{% set iParticipate = false %}
							{% for idRider in event.riderJoin %}
								{% if idRider == user._id %}
									{% set iParticipate = true %}
								{% endif %}
							{% endfor %}

							<div class="d-flex justify-content-between align-items-center">
								{% if event.riderJoin.length == 0 %}
									<a href="/rejoindreEvenement/{{event._id}}/{{authorEvent.authorEventInfo.id}}/{{user._id}}" class="btn btn-primary">Je participe</a>
								{% elseif iParticipate %}
									<a href="/annulerParticipation/{{event._id}}/{{authorEvent.authorEventInfo.id}}/{{user._id}}" class="btn btn-danger">Annuler</a>
								{% else %}
									<a href="/rejoindreEvenement/{{event._id}}/{{authorEvent.authorEventInfo.id}}/{{user._id}}" class="btn btn-primary">Je participe</a>
								{% endif %}
								<a href="/evenement/{{event.id}}/{{authorEvent.authorEventInfo.id}}" class="btn btn-light text-primary col-4">Détails</a>
							</div>
						</div>
					</article>
				{% endfor %}
			{% endfor %}
		</section>

		{# Page photos #}
		<section class="card col-12 col-md-6 col-lg-6 mt-3 bg-light mb-3 container p-0">
			<h2 class="card-title m-0 p-1">Mes photos
				<span class="text-danger">(en construction)</span>
			</h2>
			<hr class="m-0">
			<article class="row ">
				<img class="col-4 " src="/pictures/motard.jpg" alt="image de moto">
				<img class="col-4 " src="/pictures/motard.jpg" alt="image de moto">
				<img class="col-4 " src="/pictures/motard.jpg" alt="image de moto">
			</article>
		</section>

	</main>
{% endblock %}
